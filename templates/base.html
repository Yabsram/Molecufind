<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Kinase Schrodinger Stack the Future 2026">
    <meta name="keywords" content="hackathon schrodinger">
    <title>

      {% block title %}
        MolecuFind
      {% endblock title %}

    </title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>

  <body>
    <header>
      <a href="{{ url_for('select_property') }}" class="header-link">
        <img src="{{ url_for('static', filename='teamLogo.png') }}"
            alt="Our Logo"
            width="60"
            height="60">
        <h1>MolecuFind</h1>
      </a>
    </header>

    <hr class="divider">

    <h6 class="subheader"> Select your Properties </h6>

    <form method="post"
          action="{{ url_for('select_property') }}"
          class="select-form">

      <!-- AMW -->
      <div class="checkbox-group {% if selected.get('Molecular Weight') %}checked{% endif %}">
        <label>
          <input type="checkbox"
                 name="amw"
                 value="1"
                 {% if selected.get('Molecular Weight') %}checked{% endif %}>
          Atomic Molecular Weight (AMW)
        </label>
        <div class="number-input">
          <input type="number"
                 name="amw_value"
                 placeholder="Enter a value"
                 step="0.01"
                 value="{{ selected.get('Molecular Weight', '') }}">
        </div>
      </div>

      <!-- Crippen logP -->
      <div class="checkbox-group {% if selected.get('Lipophilicity') %}checked{% endif %}">
        <label>
          <input type="checkbox"
                 name="clogp"
                 value="2"
                 {% if selected.get('Lipophilicity') %}checked{% endif %}>
          Crippen logP
        </label>
        <div class="number-input">
          <input type="number"
                 name="clogp_value"
                 placeholder="Enter a value"
                 step="0.01"
                 value="{{ selected.get('Lipophilicity', '') }}">
        </div>
      </div>

      <!-- TPSA -->
      <div class="checkbox-group {% if selected.get('Polar Surface Area') %}checked{% endif %}">
        <label>
          <input type="checkbox"
                 name="tpsa"
                 value="3"
                 {% if selected.get('Polar Surface Area') %}checked{% endif %}>
          Topological Polar Surface Area (TPSA)
        </label>
        <div class="number-input">
          <input type="number"
                 name="tpsa_value"
                 placeholder="Enter a value"
                 step="0.01"
                 value="{{ selected.get('Polar Surface Area', '') }}">
        </div>
      </div>

      <!-- Number of Heavy Atoms -->
      <div class="checkbox-group {% if selected.get('Heavy Atoms') %}checked{% endif %}">
        <label>
          <input type="checkbox"
                 name="numHeavyAtoms"
                 value="4"
                 {% if selected.get('Heavy Atoms') %}checked{% endif %}>
          Number of Heavy Atoms
        </label>
        <div class="number-input">
          <input type="number"
                 name="numHeavyAtoms_value"
                 placeholder="Enter a value"
                 step="0.01"
                 value="{{ selected.get('Heavy Atoms', '') }}">
        </div>
      </div>

      <!-- Number of Aromatic Rings -->
      <div class="checkbox-group {% if selected.get('Aromatic Rings') %}checked{% endif %}">
        <label>
          <input type="checkbox"
                 name="numAromaticRings"
                 value="5"
                 {% if selected.get('Aromatic Rings') %}checked{% endif %}>
          Number of Aromatic Rings
        </label>
        <div class="number-input">
          <input type="number"
                 name="numaromaticrings_value"
                 placeholder="Enter a value"
                 step="0.01"
                 value="{{ selected.get('Aromatic Rings', '') }}">
        </div>
      </div>

      <button type="submit">Submit</button>
    </form>

    {% if selected %}

      <hr class="divider">

      <section class="results">
        <h6 class="subheader">Property Information</h6>
        <ul>
          {% for key, value in selected.items() %}<li class="filter">{{ key }}: {{ value }}</li>{% endfor %}
        </ul>
      </section>

      <hr class="divider">

      <section class="molecule-cards">
        <h6 class="subheader">Top 20 Molecule Results</h6>
        <div class="card-grid">
          {% if results is not none %}
            {% for _, molecule in results.iterrows() %}
              <div class="card">
                <img src="{{ url_for("static", filename="favicon.svg") }}"
                     alt="Molecule Image"
                     width="150"
                     height="150">
                <p>{{ molecule['Name'] }}</p>
                <button type="button" class="info-btn">More Info</button>
              </div>
            {% endfor %}
          {% endif %}
        </div>
    </section>

    <!-- Popup -->
    <div id="popup" class="popup-modal">
      <div class="popup-content">
        <span id="close-popup">x</span>
        <img id="popup-image" src="{{ url_for('static', filename='favicon.svg') }}" alt="Molecule Image" width="150" height="150">
        <p id="popup-title">Name here</p>
        <div class="comparison-chart">
          <div class="comparison-column">
              <p class="column-title">Inputted Values</p>
              <ul class="inputted-info">
                {% for key, value in selected.items() %}
                  <li>{{ key }}: {{ value }}</li>
                {% endfor %}
              </ul>
            </div>
          <div class="comparison-column">
              <p class="column-title">Actual Values</p>
                <ul class="inputted-info">
                {% for key, value in selected.items() %}
                  <li>{{ key }}: {{ value }}</li>
                {% endfor %}
              </ul>
          </div>
        </div>
      </div>
    </div>

    {% endif %}

    <hr class="divider">

    <footer>
      <img src="{{ url_for("static", filename="teamLogo.png") }}"
           alt="Our Logo"
           width="60"
           height="60">
      <div>
        <p>Made by Team Kinase</p>
        <p>Tiffany, Thuy Vi, Nathalie, and Yabby ðŸ’™</p>
      </div>
    </footer>

    <script>
    // Show/hide number input based on checkbox state
    document.querySelectorAll('.checkbox-group input[type="checkbox"]').forEach(function(checkbox) {
      checkbox.addEventListener('change', function() {
        const numberInput = this.closest('.checkbox-group').querySelector('.number-input');
        if (this.checked) {
          numberInput.style.display = 'block';
          numberInput.querySelector('input').focus();
        } else {
          numberInput.style.display = 'none';
        }
      });
    });

    // Popup functionality
    document.addEventListener('DOMContentLoaded', () => {
      const popup = document.getElementById('popup');
      const popupTitle = document.getElementById('popup-title');
      const popupImage = document.getElementById('popup-image');
      const closePopup = document.getElementById('close-popup');

      document.querySelectorAll('.info-btn').forEach(button => {
        button.addEventListener('click', () => {
          const index = button.dataset.index;

          popupTitle.textContent = `Molecule Name ${parseInt(index)+1}`;
          popupImage.src = '{{ url_for("static", filename="favicon.svg") }}';

          popup.style.display = 'flex';
        });
      });

      closePopup.addEventListener('click', () => {
        popup.style.display = 'none';
      });

      window.addEventListener('click', (e) => {
        if (e.target === popup) {
          popup.style.display = 'none';
        }
      });
    });
    
    </script>
  </body>
</html>
